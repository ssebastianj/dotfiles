# shellcheck shell=bash

#### =========================== Functions ===================================

# Assume "bash" shell by default
# 1 = bash
# 2 = zsh
# 3 = fish
guessed_shell='1'

guess_shell() {
    if [[ -n "${BASH_VERSION}" ]]; then
        # Assume shell is bash
        guessed_shell='1'
    elif [[ -n "${ZSH_VERSION}" ]]; then
        # Assume shell is zsh
        guessed_shell='2'
    elif [[ -n "${FISH_VERSION}" ]]; then
        # Assume shell is fish
        guessed_shell='3'
    fi
}
# Try to guess shell
guess_shell

is_bash_shell() {
    [[ "${guessed_shell}" == '1' ]]
}

is_zsh_shell() {
    [[ "${guessed_shell}" == '2' ]]
}

is_fish_shell() {
    [[ "${guessed_shell}" == '3' ]]
}

#### ============================ ssebastianj ================================

#### Aliases -----------------------------------------------------------------
# shellcheck source=/dev/null
[[ -s "${HOME}/.aliases" ]] && source "${HOME}/.aliases"

#### Root dir for development purposes ---------------------------------------
export DEVDIR="${HOME}/development"

#### tmuxinator --------------------------------------------------------------
export EDITOR="vim"

case "${guessed_shell}" in
    '2')
        # zsh
        if [[ -s "${HOME}/.bin/tmuxinator.zsh" ]]; then
            # shellcheck source=/dev/null
            source "${HOME}/.bin/tmuxinator.zsh"
        fi
        ;;
    '3')
        # fish
        if [[ -s "${HOME}/.bin/tmuxinator.fish" ]]; then
            cp --update --backup "${HOME}/.bin/tmuxinator.fish" "${HOME}/.config/fish/completions/"
        fi
        ;;
           
    *)
        # bash
        if [[ -s "${HOME}/.bin/tmuxinator.bash" ]]; then
            # shellcheck source=/dev/null
            source "${HOME}/.bin/tmuxinator.bash"
        fi
        ;;
esac

#### Node Version Manager ----------------------------------------------------
autoload -Uz nvm

#### Python ------------------------------------------------
export PATH="${HOME}/.local/bin:${PATH}"
export WORKON_HOME="${DEVDIR}/.virtualenvs"

#### Django ------------------------------------------------------------------
DJANGO_COMPLETION_FILE="${DEVDIR}/django/extras/django_bash_completion"

if [[ -s "${DJANGO_COMPLETION_FILE}" ]]; then
    is_zsh_shell && autoload -Uz bashcompinit && bashcompinit

    # shellcheck source=/dev/null
    source "${DJANGO_COMPLETION_FILE}"
fi

#### Git ---------------------------------------------------------------------
export PATH="${HOME}/.git-contrib:${PATH}"

#### Golang ------------------------------------------------------------------
export GOPATH="${DEVDIR}/gocode"
export PATH="${GOPATH}/bin:${PATH}"

#### Rust --------------------------------------------------------------------
export RUSTUP_HOME="${HOME}/.rustup"
export CARGO_HOME="${HOME}/.cargo"
export PATH="${RUSTUP_HOME}/bin:${CARGO_HOME}/bin:${PATH}"

RUST_GIT_SRC_DIR="${DEVDIR}/rust/src"
if [[ -d "${RUST_GIT_SRC_DIR}" ]]; then
    export RUST_SRC_PATH="${RUST_GIT_SRC_DIR}"
else
    RUST_SYSROOT="$(rustc --print sysroot)"
    export RUST_SRC_PATH="${RUST_SYSROOT}/lib/rustlib/src/rust/src"
fi
